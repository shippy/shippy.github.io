---
import Base from "./Base.astro";

import type { CollectionEntry } from "astro:content";
import { getEntries } from "astro:content";
import defaultHeroImage from "../assets/default_other_hero_image.png";

import { Image } from "astro:assets";

type Props = CollectionEntry<"side_projects">["data"];

const {
  title,
  description,
  pubDate,
  heroImage,
  githubUrl,
  projectUrl,
  blogRef,
  technologies,
  screenshots,
} = Astro.props;
const blogs = blogRef ? await getEntries(blogRef) : undefined;
---

<Base title={title} description={description || ""}>
  <main>
    <article>
      <div class="hero-image">
        {
          heroImage ? (
            <Image width={1020} height={510} src={heroImage} alt="" />
          ) : (
            <Image width={1020} height={510} src={defaultHeroImage} alt="" />
          )
        }
      </div>
      <div class="prose">
        <div class="title">
          <div class="date">
            <!-- <FormattedDate date={pubDate} /> -->
          </div>
          <h1>{title}</h1>
          {description && <p>{description}</p>}
          <hr />
        </div>
        <div class="links">
          <ul>
            {
              githubUrl && (
                <li>
                  <a href={githubUrl}>Source code available.</a>
                </li>
              )
            }
            {
              projectUrl && (
                <li>
                  <a href={projectUrl}>Project deployed.</a>
                </li>
              )
            }
            {
              blogs &&
                blogs.map((blog) => (
                  <li>
                    Blog: <a href={`/blog/${blog.slug}`}>{blog.data.title}</a>
                  </li>
                ))
            }
          </ul>
        </div>
        {
          technologies && (
            <div class="technologies">
              <h2>Technologies Used</h2>
              <ul>
                {technologies.map((tech) => (
                  <li>#{tech}</li>
                ))}
              </ul>
            </div>
          )
        }
        {
          screenshots && (
            <div class="screenshots">
              <h2>Screenshots</h2>
              {screenshots.map((screenshot) => (
                <Image width={1020} height={510} src={screenshot} alt="" />
              ))}
            </div>
          )
        }
        <slot />
      </div>
    </article>
  </main>
</Base>
